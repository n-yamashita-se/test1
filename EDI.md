# 目的
EDI.accdbの内部分析結果を明文化する。
ナブテスコ各カンパニー（鉄道c、住環境c、舶用c）のEDIデータ(csvファイル）を入手し、上記で処理後、Sunelcoで処理を行う。

# Csv取込
本要望の概要を以下に示す。
1. jobとsuffixを入力して、欠品の子品番とオーダ残情報を表示して欲しい。
   - 子品番が購買品（item_mst.p_m_t_code='P'）ならば購買オーダ残、製造品ならばjobオーダ残を表示する。
2. 購買受入や入庫した際に欠品job、欠品工程、次工程先などを表示して欲しい。
3. job.suffix でのスケジューラ表示で払出状況を表示して欲しい。

# 各カンパニー
- テーブル「T_wc_payout」：欠品を抽出するwc（ワークセンタ）をこのテーブルにINSERTする。
- ストアド「P_QPT_payout_shortage_disp」：上記 **関係部署要望** に基づく情報を取得し、SELECTする。
  - 例えば、1つのjob.suffixでwc='A001'［組立部品払出（生管課）〕が複数の工程No（oper_num）で存在する場合があるため、工程Noも踏まえて情報を取得する。
  - 払出工程があるのに子品番が存在しないjob.suffixもあったので、「子品番無し」も表示できるようにする。
- テーブル値関数「Ftb_jobroute_next_oper」：次工程情報を取得する。
  - 次工程が「外注」の場合、外注先名を下記の3種類いずれかで取得する。
    - 次工程wcが'O_%'の場合、そのwc名
    - 次工程wcが'OUT13'の場合、子品番倉庫名
    - 次工程でjob-購買相互参照の購買オーダが有る場合、その発注先名
- テーブル「T_payout_shortage_disp_log」：本欠品情報の実行履歴を保存する。
   - いずれかのボタンを実行した際、実行者の社員CDや実行したボタンを保存する。
   - 使用頻度等が確認できれば削除予定。

# Access（工程会議.accdb）操作
メイン画面の「欠品情報」をクリックし、上記 **関係部署要望** のNo.1～3を下記ボタンのクリックで表示する。
1. 「job欠品詳細」ボタン
2. 「子品番の欠品job」ボタン

