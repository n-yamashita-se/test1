# 目的
EDI.accdbの内部分析結果を明文化する。  
ナブテスコ各カンパニー（鉄道c、住環境c、舶用c）のEDIデータ（csvファイル）を入手し、上記で取込後、Sunelcoで処理を行う。

# Csv取込
1. 入手したEDIデータ（csvファイル）の取込処理。取込結果はSQLサーバの「NabtescoEDI」データベース内のテーブルに保存される。
2. csvファイル名のルールは下記
   - 「*KB.csv」：神戸工場（鉄道c）
   - 「*KN.csv」：甲南工場（住環境c）
   - 「*SM.csv」：西神工場（舶用c）
   - 「*YP.csv」：山形工場。2010/03/01以降、csvファイル内部の処理は未対応
3. csvファイル内のカラム「情報区分」の値によって下記に分類される
   - 「N201」：長期数量情報。取込未対応。
   - 「0301」：見積依頼。取込未対応。
   - 「0401」：支給予定。取込未対応。
   - 「0402」：支給実績。取込未対応。
   - 「0502」：新規注文情報。VBAのGetOrder()関数により、「★」テーブルに保存される。
   - 
4. あああ
 

# 各カンパニー
- テーブル「T_wc_payout」：欠品を抽出するwc（ワークセンタ）をこのテーブルにINSERTする。
- ストアド「P_QPT_payout_shortage_disp」：上記 **関係部署要望** に基づく情報を取得し、SELECTする。
  - 例えば、1つのjob.suffixでwc='A001'［組立部品払出（生管課）〕が複数の工程No（oper_num）で存在する場合があるため、工程Noも踏まえて情報を取得する。
  - 払出工程があるのに子品番が存在しないjob.suffixもあったので、「子品番無し」も表示できるようにする。
- テーブル値関数「Ftb_jobroute_next_oper」：次工程情報を取得する。
  - 次工程が「外注」の場合、外注先名を下記の3種類いずれかで取得する。
    - 次工程wcが'O_%'の場合、そのwc名
    - 次工程wcが'OUT13'の場合、子品番倉庫名
    - 次工程でjob-購買相互参照の購買オーダが有る場合、その発注先名
- テーブル「T_payout_shortage_disp_log」：本欠品情報の実行履歴を保存する。
   - いずれかのボタンを実行した際、実行者の社員CDや実行したボタンを保存する。
   - 使用頻度等が確認できれば削除予定。

# Access（工程会議.accdb）操作
メイン画面の「欠品情報」をクリックし、上記 **関係部署要望** のNo.1～3を下記ボタンのクリックで表示する。
1. 「job欠品詳細」ボタン
2. 「子品番の欠品job」ボタン

