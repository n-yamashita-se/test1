# 目的
portal、「納入仕様書」ソフトに関する情報を記載する。

# 情報源
- 文書No.RA-0444-01
- 技術部 星野課長に問い合わせた内容

# 画面例
![20240710_01_portal_納入仕様書](https://github.com/n-yamashita-se/test1/assets/120544602/4387fe96-8e33-4fe4-a9a8-166b4557914d)

# 基本機能
本ソフトの主目的は「受注品番の納入仕様書目録にある図番の改訂記号（納入仕様書発行時）が最新改訂記号と異なる場合に表示し、納入仕様書の更新状況も表示し、配布発行されれば表示から消す」であり、これを実現するために以下の機能も追加している。
1. SB番号が照合できない受注品番の表示。受注品番もしくは受注品番の型式が、文書台帳.dbo.TSB番号.品番 と一致すれば、そのSB番号になるが、一致する
   1. 受注品番と文書台帳.dbo.TSB番号.品番（品番の値が型式の場合もある）が一致するかどうか。
   2. 受注型式が文書台帳.dbo.T文書台帳に
   3. 
2. 納入仕様書が照合できない受注品番の表示。受注品番の型式が、文書台帳.dbo.納入仕様書.顧客図面番号 と一致すれば、その納入仕様書になるが、一致するレコードがなければ本ソフトで表示し、納入仕様書との紐付けか、納入仕様書不要の処理を担当者が行う。
一致するレコードがなければ本ソフトで表示し、納入仕様書との紐付けか、納入仕様書不要の処理を担当者が行う。

★目録図番が別の納入仕様書で提出済みの場合、その別の納入仕様書も改訂が必要であれば表示する



# 本ソフトで使用されていると考えられるテーブル
1. kyokko.dbo.train_black_list：★用途不明★。星野課長よりレコード追加されているが、section_no IN ('720', '730')で、文書台帳.dbo.T部署ではナブテスコ住環境c、ナブテスコ鉄道cになるが、両者発行の図番は対象外とするかもしれない。
2. kyokko.dbo.train_config：★用途不明★。レコードはcompany_no='10002A'のみで、本ソフトの対象顧客がナブテスコ鉄道cとしているかもしれない。
3. kyokko.dbo.train_linked_doc：本ソフトで紐付け処理した受注品番と納入仕様書をレコードとするテーブル
4. kyokko.dbo.train_linked_sbno：本ソフトで紐付け処理した受注品番とSB番号をレコードとするテーブル
5. kyokko.dbo.train_missing_doc：納入仕様書が無いと判定された受注品番をレコードとするテーブル
6. kyokko.dbo.train_missing_sbno：SB番号が無いと判定された受注品番をレコードとするテーブル
7. kyokko.dbo.train_needless_doc：本ソフトで納入仕様書を不要と処理した受注品番をレコードとするテーブル
8. kyokko.dbo.train_needless_sbno：本ソフトでSB番号を不要と処理した受注品番をレコードとするテーブル
9. kyokko.dbo.train_old_tenp：★用途不明★。
10. kyokko.dbo.train_old_tenp_bak：★用途不明★。
11. kyokko.dbo.train_server_log：★用途不明★。レコード的にはINSERTログのようであり、受注品番とSB番号の紐付け、受注品番と納入仕様書の紐付けの可能性は高いが、カラムmemoにある「revision -」が不明。

# portal、「納入仕様書」、「SB番号を登録してください」

「SB番号は不要」と処理した受注品番は、納入仕様書も不要。

受注品番とSB番号の紐付け

受注品番と納入仕様書の紐付けは、納入仕様書の



カラム「更新」について
- 納入仕様書の目録図番で改訂記号に差異があれば、その納入仕様書をレコード表示、カラム「更新」は空白
- 納入仕様書の目録図番で改訂記号に差異がない（納入仕様書の改訂作業終了）と、カラム「更新」は「○」表示
- 改訂作業した納入仕様書が配布される（文書台帳.dbo.T配布先.発行日がNULLでない）と、レコードをDELETE。


# 履歴
- 2024/07/12、山下、新規作成
