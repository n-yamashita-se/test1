# 目的
portal、「納入仕様書」ソフトに関する情報を記載する。

# 情報源
- 文書No.RA-0444-01
- 技術部 星野課長に問い合わせた内容

# 画面例
![20240710_01_portal_納入仕様書](https://github.com/n-yamashita-se/test1/assets/120544602/4387fe96-8e33-4fe4-a9a8-166b4557914d)

# 基本機能
本ソフトは「当社が発行している納入仕様書に対する品番の受注時、納入仕様書目録にある図面の改訂記号が最新改訂記号と異なる場合（例えばCPS-B0000が納入仕様書発行時は改訂aだが、最新改訂がb）、その情報を見える化することで最新改訂図面を顧客へ提出するアクションを取らせる」ことを主目的とする。この目的実現のために以下の機能も追加している。
1. SB番号が照合できない受注品番の表示。受注品番の型式が 文書台帳.dbo.TSB番号.品番 と一致すれば表示対象外（文書台帳.dbo.TSB番号.SB番号 で照合する為）だが、一致するレコードがなければ、受注品番とSB番号の紐付けか、SB番号不要の処理を担当者が行える。
2. 納入仕様書が照合できない受注品番の表示。受注品番の型式が 文書台帳.dbo.納入仕様書.顧客図面番号 と一致すれば表示対象外（文書台帳.dbo.納入仕様書.納入仕様書 で照合する為）だが、一致するレコードがなければ受注品番と納入仕様書との紐付けか、納入仕様書不要の処理を担当者が行える。
3. 
4. 目録図番が別の納入仕様書で提出済みの場合、その別の納入仕様書も改訂が必要であれば表示する 
5. 納入仕様書の更新状況も表示し、配布発行されれば表示から消す」であり、
6. 

★



# 本ソフトで使用されていると考えられるテーブル
1. kyokko.dbo.train_black_list：★用途不明★。星野課長よりレコード追加されているが、section_no IN ('720', '730')で、文書台帳.dbo.T部署ではナブテスコ住環境c、ナブテスコ鉄道cになるが、両者発行の図番は対象外とするかもしれない。
2. kyokko.dbo.train_config：★用途不明★。レコードはcompany_no='10002A'のみで、本ソフトの対象顧客がナブテスコ鉄道cとしているかもしれない。
3. kyokko.dbo.train_linked_doc：本ソフトで紐付け処理した受注品番と納入仕様書をレコードとするテーブル
4. kyokko.dbo.train_linked_sbno：本ソフトで紐付け処理した受注品番とSB番号をレコードとするテーブル
5. kyokko.dbo.train_missing_doc：納入仕様書が無いと判定された受注品番をレコードとするテーブル
6. kyokko.dbo.train_missing_sbno：SB番号が無いと判定された受注品番をレコードとするテーブル
7. kyokko.dbo.train_needless_doc：本ソフトで納入仕様書を不要と処理した受注品番をレコードとするテーブル
8. kyokko.dbo.train_needless_sbno：本ソフトでSB番号を不要と処理した受注品番をレコードとするテーブル
9. kyokko.dbo.train_old_tenp：★用途不明★。
10. kyokko.dbo.train_old_tenp_bak：★用途不明★。
11. kyokko.dbo.train_server_log：★用途不明★。レコード的にはINSERTログのようであり、受注品番とSB番号の紐付け、受注品番と納入仕様書の紐付けの可能性は高いが、カラムmemoにある「revision -」が不明。

# 画面の一番上、「SB番号を登録してください」
SB番号が無いと判定された受注品番がテーブル「kyokko.dbo.train_missing_sbno」にあり、これを表示する。同時に
- 受注品番の型式が、文書台帳.dbo.T文書台帳にあれば、文書台帳.dbo.T文書台帳.SB番号をカラム「SB番号※1」に表示
- 受注品番の型式で種別（型式が「XXXX-YYYYYYY-ZZ」の場合「-ZZ」が種別）を除いたものが文書台帳.dbo.TSB番号.品番の種別を除いたものに等しい場合、文書台帳.dbo.TSB番号.SB番号をカラム「SB番号※2」に表示
  

「SB番号は不要」と処理した受注品番は、納入仕様書も不要。

受注品番とSB番号の紐付け

受注品番と納入仕様書の紐付けは、納入仕様書の



カラム「更新」について
- 納入仕様書の目録図番で改訂記号に差異があれば、その納入仕様書をレコード表示、カラム「更新」は空白
- 納入仕様書の目録図番で改訂記号に差異がない（納入仕様書の改訂作業終了）と、カラム「更新」は「○」表示
- 改訂作業した納入仕様書が配布される（文書台帳.dbo.T配布先.発行日がNULLでない）と、レコードをDELETE。


# 履歴
- 2024/07/12、山下、新規作成
